<!--pip install django-widget-tweaks-->
{% extends 'myapp/index.html' %}


 {% block content %}
{% load static %}
{% load widget_tweaks %}
<div class="row">
  <div class="col-lg-12">
      <div class="card">
          <div class="card-body">
              <div class="email-left-box px-0 mb-3">
                  <div class="p-0">
                      <a href="email-compose.html" class="btn btn-primary btn-block">ارسال</a>
                  </div>
                  <div class="mail-list mt-4">
                      <a href="email-inbox.html" class="list-group-item active"><i class="fa fa-inbox font-18 align-middle mr-2"></i> صندوق <span class="badge badge-primary badge-sm float-right">198</span> </a>
                      <a href="javascript:void()" class="list-group-item"><i class="fa fa-paper-plane font-18 align-middle mr-2"></i>ارسال شده</a> <a href="javascript:void()" class="list-group-item"><i class="fa fa-star-o font-18 align-middle mr-2"></i>مهم <span class="badge badge-danger text-white badge-sm float-right">47</span>
                  </a>
                      <a href="javascript:void()" class="list-group-item"><i class="mdi mdi-file-document-box font-18 align-middle mr-2"></i>پیش نویس</a><a href="javascript:void()" class="list-group-item"><i class="fa fa-trash font-18 align-middle mr-2"></i>سطل زباله</a>
                  </div>
                  <div class="intro-title d-flex justify-content-between">
                      <h5>دسته بندی ها</h5>
                      <i class="fa fa-chevron-down" aria-hidden="true"></i>
                  </div>
                  <div class="mail-list mt-4">
                      <a href="email-inbox.html" class="list-group-item"><span class="icon-warning"><i class="fa fa-circle" aria-hidden="true"></i></span>
                          کاری </a>
                      <a href="email-inbox.html" class="list-group-item"><span class="icon-primary"><i class="fa fa-circle" aria-hidden="true"></i></span>
                          شخصی </a>
                      <a href="email-inbox.html" class="list-group-item"><span class="icon-success"><i class="fa fa-circle" aria-hidden="true"></i></span>
                          دوستانه </a>
                      <a href="email-inbox.html" class="list-group-item"><span class="icon-dpink"><i class="fa fa-circle" aria-hidden="true"></i></span>
                          شبکه مجازی </a>
                  </div>
              </div>
              <div class="email-right-box ml-0 ml-sm-4 ml-sm-0">
                  <div class="toolbar mb-4" role="toolbar">
                      <div class="btn-group mb-1">
                          <button type="button" class="btn btn-primary light px-3"><i class="fa fa-archive"></i></button>
                          <button type="button" class="btn btn-primary light px-3"><i class="fa fa-exclamation-circle"></i></button>
                          <button type="button" class="btn btn-primary light px-3"><i class="fa fa-trash"></i></button>
                      </div>
                      <div class="btn-group mb-1">
                          <button type="button" class="btn btn-primary light dropdown-toggle px-3" data-toggle="dropdown">
                              <i class="fa fa-folder"></i> <b class="caret m-l-5"></b>
                          </button>
                          <div class="dropdown-menu">
                              <a class="dropdown-item" href="javascript: void(0);">سوشال مدیا</a>
                              <a class="dropdown-item" href="javascript: void(0);">پیشنهاد ها</a>
                              <a class="dropdown-item" href="javascript: void(0);">آپدیت ها</a>
                              <a class="dropdown-item" href="javascript: void(0);">پرسش و پاسخ ها</a>
                          </div>
                      </div>
                      <div class="btn-group mb-1">
                          <button type="button" class="btn btn-primary light dropdown-toggle px-3" data-toggle="dropdown">
                              <i class="fa fa-tag"></i> <b class="caret m-l-5"></b>
                          </button>
                          <div class="dropdown-menu">
                              <a class="dropdown-item" href="javascript: void(0);">آپدیت ها</a>
                              <a class="dropdown-item" href="javascript: void(0);">سوشال مدیا</a>
                              <a class="dropdown-item" href="javascript: void(0);">پیشنهاد ها</a>
                              <a class="dropdown-item" href="javascript: void(0);">پرسش و پاسخ ها</a>
                          </div>
                      </div>
                      <div class="btn-group mb-1">
                          <button type="button" class="btn btn-primary light dropdown-toggle v" data-toggle="dropdown">بیشتر <span class="caret m-l-5"></span>
                          </button>
                          <div class="dropdown-menu"><a class="dropdown-item" href="javascript: void(0);">
                              نشان خوانده نشده
                          </a> <a class="dropdown-item" href="javascript: void(0);">
                              اضافه کردن به کارها
                          </a>
                              <a class="dropdown-item" href="javascript: void(0);">امتیاز دهی</a> <a class="dropdown-item" href="javascript: void(0);">خاموش کردن</a>
                          </div>
                      </div>
                  </div>
                  <div class="compose-content">
                    <form action="{% url 'mail_create' %}" method="post" id='msg_form'>
                        {% csrf_token %}
                        {{ form.fromUser.as_hidden }}
                        {{ form.messageStatus.as_hidden }}
                        <input type="hidden" name="file_id" value='-1' id='file_id'>

                        <div class="form-group">

                            {% render_field form.toUser class="form-control selectpicker" data-show-subtext="true" data-live-search="true" placeholder="به کی : "  %}
                        </div>
                        <div class="form-group">
                            {% render_field form.subject class="form-control bg-transparent" placeholder=" موضوع : "  %}

                        </div>
                        <div class="form-group">
                            {% render_field form.Message class="textarea_editor form-control bg-transparent" placeholder=" موضوع : " placeholder="متن را بنویس ..." %}
                            <script>
   // These styles are used to provide the "page view" display style like in the demo and matching styles for export to PDF.
   CKEDITOR.addCss(
     'body.document-editor { margin: 0.5cm auto; border: 1px #D3D3D3 solid; border-radius: 5px; background: white; box-shadow: 0 0 5px rgba(0, 0, 0, 0.1); }' +
     'body.document-editor, div.cke_editable { width: 700px; padding: 1cm 2cm 2cm; } ' +
     'body.document-editor table td > p, div.cke_editable table td > p { margin-top: 0; margin-bottom: 0; padding: 4px 0 3px 5px;} ' +
     'blockquote { font-family: sans-serif, Arial, Verdana, "Trebuchet MS", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; } ');

   var editor = CKEDITOR.replace('id_Message', {

     extraPlugins: 'colorbutton,font,justify,print,tableresize,liststyle,pagebreak,exportpdf',
     toolbar: [{
         name: 'various',
         items: ['ExportPdf', '-', 'Undo', 'Redo']
       },
       {
         name: 'basicstyles',
         items: ['Bold', 'Italic', 'Underline', 'Strike', 'RemoveFormat', 'Subscript', 'Superscript']
       },
       {
         name: 'links',
         items: ['Link', 'Unlink']
       },
       {
         name: 'paragraph',
         items: ['NumberedList', 'BulletedList', '-', 'Outdent', 'Indent', '-', 'Blockquote']
       },
       {
         name: 'insert',
         items: ['Image', 'Table']
       },
       {
         name: 'editing',
         items: ['Scayt']
       },
       '/',
       {
         name: 'styles',
         items: ['Format', 'Font', 'FontSize']
       },
       {
         name: 'colors',
         items: ['TextColor', 'BGColor', 'CopyFormatting']
       },
       {
         name: 'align',
         items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']
       },
       {
         name: 'document',
         items: ['PageBreak', 'Source']
       }
     ],
     bodyClass: 'document-editor',
     removeButtons: 'PasteFromWord'
   });
 </script>

                        </div>

                    </form>
                    <h5 class="mb-4"><i class="fa fa-paperclip"></i> فایل پیوست</h5>
                    <form action="{% url 'file_upload'  %}" class="dropzone dz-clickable" id="mydrop">
                        {% csrf_token %}

                    <div class="dz-default dz-message" id="myfiles"><button class="dz-button" type="button">Drop files here to upload</button></div>
                </form>
                </div>


                  <div class="text-left mt-4">
                      <button class="btn btn-primary btn-sl-sm mr-2 sub_mail" type="button"><span class="mr-2"><i class="fa fa-paper-plane"></i></span>ارسال
                      </button>
                      <button class="btn btn-danger light btn-sl-sm" type="button"><span class="mr-2"><i class="fa fa-times" aria-hidden="true"></i></span>کنسل
                      </button>
                  </div>
              </div>
          </div>
      </div>
  </div>
</div>


{% load static %}

{% block javascript %}
<script src="{% static '/js/project/mail.js' %}"></script>
<script >
//"myAwesomeDropzone" is the camelized version of the HTML element's ID

$(document).ready(function () {

       Dropzone.options.mydrop = {

           maxFilesize: 10,
           init: function () {


              this.on("complete", file => {
              var aval=[];
               if($("#file_id").val()!="-1")
               aval.push($("#file_id").val());
               aval.push(JSON.parse(file.xhr.response).id)
               $("#file_id").val(aval);

  });
           }

       };
   });
</script>



{% endblock %}
{% endblock %}
